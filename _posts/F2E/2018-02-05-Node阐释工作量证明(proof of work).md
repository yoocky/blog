---
layout:     post
title:      Node阐释工作量证明(proof of work)
date:       2018-02-05 12:32:18
summary:   工作量证明是指系统为达到某目标而设置的工作度量方法.一開始是用在网络攻防上,大大提高攻击者的计算量,攻击成本也就上去了. 工作量证明须要由工作者和验证者双方共同完毕.它有两层含义. 1.工作者须要完毕的工作必须有一定的量,这个量由验证者给出. 2.验证者能够迅速的检验工作量是否达标,注意这里的检验完毕过程必须简单.
categories: F2E
---

了解比特币的都知道挖矿非常耗电,这是由于比特币用到了工作量证明.

工作量证明是指系统为达到某目标而设置的工作度量方法.一開始是用在网络攻防上,大大提高攻击者的计算量,攻击成本也就上去了.
工作量证明须要由工作者和验证者双方共同完毕.它有两层含义.
+   1.工作者须要完毕的工作必须有一定的量,这个量由验证者给出.
+   2.验证者能够迅速的检验工作量是否达标,注意这里的检验完毕过程必须简单.

举几个样例
*   A跟B说,你给我还原这个魔方,B还原魔方须要非常多时间,而A验证却非常快,仅仅须要看一眼即可了.
*   A跟B说,你给我解这个10次方程,过程非常麻烦,可是结果easy验证.
*   A跟B说,你给我把这个游戏玩通关,B须要一定时间,而A验证却非常快.
RSA算法基于一个十分简单的数论事实:将两个大素数相乘十分easy,可是想要对其乘积进行因式分解却极其困难.
...

在计算机系统中,能够这样设计:
验证者给定一个随机字符串s,工作者必须找出一个数n,使得随机字符串拼上这个数n后的md5结果前面几位都是0.
即md5(s+n)的结果符合验证者的要求.工作者仅仅能不停的穷举,找出这样一个数n.

以下是Javascript代码.
工作方:

    import crypto from 'crypto';
    var md5 = (str) => {
        let _md5 = crypto.createHash("md5");
        _md5.update(str);
        return _md5.digest('hex');
    }
    var msg = 'randomstring';
    let n = 0;
    var hashid = md5(msg + n);
    while(!/^0000/.test(hashid)) {
        n++;
        hashid = md5(msg + n);
    }
    console.log(n);

输出39496 00001c48020e444f58a297a0785df5cf,即工作方须要md5()39496次.

而验证方仅仅须要拿工作方给过来的n,进行一次md5就可以验证.
即 /^0000/.test(md5(msg + n)).

由于md5用十六进制表示,每一位出现的概率是16.所以工作者要找到前面4位都是0平均须要16*16*16*16=65536次.
验证者能够依据自身须要来规定前面0的个数来控制工作者的工作量.想要对方耗多点电,那就多加几个0吧.