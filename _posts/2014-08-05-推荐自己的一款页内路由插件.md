---
layout:     post
title:      推荐自己的一款页内路由插件
date:       2014-08-05 12:32:18
summary:    基于hash单页路由控制，快速搭建单页面应用
categories: 前端
---

在聊单页路由之前我们下看下面这个需求场景
这是个帮助页面的常见问题聚合页，用户点一个问题然后打开对应问题的帮助页，而这种页面也一般是放在cms中，让运营同学去编辑
我们该怎么去建cms文件和controller呢！如果一个一个页面去加实在是蛋疼，这个就是单页路由很好的应用场景。

* 什么是银行预留手机号？<br>
 银行预留手机号，一般是当你去办理……
* 如何修改预留手机号？<br>
 不同银行的修改预留手机号的方法……
* 提示“网络超时”，怎么办？<br>
 可能是因为网络不稳定导致……
* 支付时收不到短信验证码怎么办？<br>
收不到验证码可能有三种情况……
* 钱扣了为什么没到账？<br>
由于充值过程中需要多处渠道共同支持……

再想想类似的需求场景很多，尤其是移动端的页面，每个页面其实承载的展示内容要比pc页面少的多，不同页面很多逻辑可以复用， 跨页面数据传输通信
这样如果做成单页从用户的体验和可维护性上都有很大的优势

下面是自己未来满足常用的业务需求锤炼的一款单页路由插件托管在github上：


###[router.js](https://github.com/yoocky/router)
###库文件依赖：
 * zepto.js 或者 jQuery

###兼容性:
 
|Chrome |Firefox |(Gecko)   |IE|    Opera|  Safari| IPHONE| Android|
| ----   | ----     | ----     | ---- |----    |----     | ---- |----    |
|5+ |3.6+| (1.9.2)+|    8.0+(标准模式)| 11.60+  |5.0+|  5.0+|   2.2+|

###功能描述：
 * 1、支持历史记录，响应浏览器的前进后退
 * 2、支锚标记 href="#controller" 格式跳转
 * 3、支持open("controller")方法打开页面
 * 4、支持设置默认首页，
 * 5、支持带hash值的url直接打开对应页面
 * 6、支持页面切换绑定事件
 * 7、暂不支持页面切换自定义动画效果
 
###实例化router：
####html结构
 ```html
    <content singlePage>
        <div page="index" title="首页" style="display:none">
          <h2>这是首页</h2>
          <p>这是一个简单的单页路由，吸取了angular和backbone的特点</p>
        </div>
        <div page="page1" title="页面1" style="display:none">
          <h2>这是第一个子页面</h2>
          <p>很简单的配置</p>
        </div>
        <div page="page2" title="页面2" style="display:none">
          <h2>这是第二个子页面</h2>
          <p>更改hash是可以产生历史记录的</p>
        </div>
    </content>
```

####JavaScript
#####1、自动化配置：
```javascript
    var appRoute = new Router();
```

#####2、自定义配置：
```javascript
    var appRoute = new Router({
        controller: {
            "index": {},
            "page1": {},
            "page2": {}
    },
        index : "index",
            
   });
```

###router参数说明：
####基本配置参数



| 参数名 | 数据类型 | 数据结构 |默认值|功能描述|
| ----   | ----     | ----     | ---- |----    |
| controller  | Object    | {"pagename": {}}    |   自动生成|路由控制器|
| index | String | |   自动在页面上取第一个有效的cotroller|设置默认的首页|
| wrap | String |   |   "singlePage"|路由作用范围的属性标识|
| pageFlag | String |  |   "page"|路由内部的分页标识|

####部分状态参数（只读）

| 参数名 | 数据类型 |默认值|功能描述|
| ----   | ----     | ----     | ---- |----    |
| path.root | String |  自动生成 | 当前页面的根路径<br/>等价于 location.origin + location.pathname| 
| path.curPage | String | 动态维护 | 当前页面的索引值| 

####自定义 Events 的相关参数
| 事件名 | 传递参数 | 触发时机|
| ----   | ----   |---- |
| beforeOpen  |  arguments[0] String 预打开页的索引 <br/> arguments[1] String 当前页的索引  | 预切换页面前 |
| afterOpen   |  arguments[0] String 已打开页的索引 <br/> arguments[1] String 前一个页面的索引| 切换页面成功后 |

###router方法API：

| 方法名 | 参数 | 功能描述|
| ----   | ----   |---- |
| open  |  arguments[0] String  预打开页面的索引<br/> arguments[1] Function 打开页面成功后的回调 | 打开一个新页面，并改变hash值 |
| on   |  arguments[0] String 事件名 <br/> arguments[1] Function 回调函数| 添加事件绑定 |
| off  |  arguments[0] String 事件名 <br/> arguments[1] Function 回调函数| 解除事件绑定 |
| trigger  |  arguments[0] String 事件名 <br/> arguments[1] Function 回调函数| 触发事件 |
